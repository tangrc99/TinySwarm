<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TinySwarm: tiny_swarm::worker::WorkerNode Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TinySwarm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>tiny_swarm</b></li><li class="navelem"><b>worker</b></li><li class="navelem"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html">WorkerNode</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classtiny__swarm_1_1worker_1_1_worker_node-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">tiny_swarm::worker::WorkerNode Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_worker_node_8h_source.html">WorkerNode.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2ddcd16a9f64fd1541514f8f7a65dbbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a2ddcd16a9f64fd1541514f8f7a65dbbb">WorkerNode</a> (const std::string &amp;work_dir)</td></tr>
<tr class="separator:a2ddcd16a9f64fd1541514f8f7a65dbbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a154586afdfdc8eb9317a4e3030d0e908"><td class="memItemLeft" align="right" valign="top">pid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a154586afdfdc8eb9317a4e3030d0e908">createProcess</a> (const std::string &amp;service, const std::string &amp;alias, const std::string &amp;manager, int type, int port, std::vector&lt; char * &gt; exe_params, std::vector&lt; char * &gt; docker_params, std::string &amp;error_text, int restart=0)</td></tr>
<tr class="separator:a154586afdfdc8eb9317a4e3030d0e908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc45b31d721f36afb4a08bcfb56315d"><td class="memItemLeft" align="right" valign="top">pid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a5dc45b31d721f36afb4a08bcfb56315d">createProcess</a> (const <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_descriptor.html">PodDescriptor</a> &amp;pd, std::string &amp;error_text)</td></tr>
<tr class="separator:a5dc45b31d721f36afb4a08bcfb56315d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae429841d6f8d4a57291110eefed7ba5f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#ae429841d6f8d4a57291110eefed7ba5f">stopPod</a> (<a class="el" href="structtiny__swarm_1_1worker_1_1_pod_descriptor.html">PodDescriptor</a> *pd)</td></tr>
<tr class="separator:ae429841d6f8d4a57291110eefed7ba5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ba730850f84b99e8a6600cebfc83722"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a1ba730850f84b99e8a6600cebfc83722">stopHostPod</a> (pid_t pid)</td></tr>
<tr class="separator:a1ba730850f84b99e8a6600cebfc83722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66c07d8395e4c39c13791ea4c1e3693"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#ad66c07d8395e4c39c13791ea4c1e3693">stopPod</a> (const std::string &amp;alias, const std::string &amp;manager)</td></tr>
<tr class="separator:ad66c07d8395e4c39c13791ea4c1e3693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a225d8b3337f181db41a4f101c5b6c99e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a225d8b3337f181db41a4f101c5b6c99e">stopDockerPod</a> (pid_t pid)</td></tr>
<tr class="separator:a225d8b3337f181db41a4f101c5b6c99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e7dcb61565460b2f6220dc600441e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#ab1e7dcb61565460b2f6220dc600441e1">stopDockerPod</a> (const std::string &amp;alias, const std::string &amp;manager)</td></tr>
<tr class="separator:ab1e7dcb61565460b2f6220dc600441e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edf9e05f42a817eea1739d8ebc5f678"><td class="memItemLeft" align="right" valign="top"><a id="a9edf9e05f42a817eea1739d8ebc5f678" name="a9edf9e05f42a817eea1739d8ebc5f678"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>checkIfAliasOK</b> (const std::string &amp;manager, const std::string &amp;alias, std::string &amp;reason)</td></tr>
<tr class="separator:a9edf9e05f42a817eea1739d8ebc5f678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a765418b0c3055848eb6ac961f23c3878"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a765418b0c3055848eb6ac961f23c3878">checkIfPodsRunning</a> ()</td></tr>
<tr class="separator:a765418b0c3055848eb6ac961f23c3878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af90f4c02825f1d36171f47c4bc84cea2"><td class="memItemLeft" align="right" valign="top"><a id="af90f4c02825f1d36171f47c4bc84cea2" name="af90f4c02825f1d36171f47c4bc84cea2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>checkPodsUsingProbe</b> ()</td></tr>
<tr class="memdesc:af90f4c02825f1d36171f47c4bc84cea2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check services. If pod cannot response the live probe, pod will be set down. <br /></td></tr>
<tr class="separator:af90f4c02825f1d36171f47c4bc84cea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab35e1de5d9134fcb16567ecf5ee1e747"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#ab35e1de5d9134fcb16567ecf5ee1e747">collectExitInformation</a> (const std::string &amp;manager, std::list&lt; <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_exit_information.html">PodExitInformation</a> &gt; &amp;exits)</td></tr>
<tr class="separator:ab35e1de5d9134fcb16567ecf5ee1e747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f8edc78a507cfcb9a7eabfe771fc36e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a8f8edc78a507cfcb9a7eabfe771fc36e">cleanDumpFiles</a> (const std::list&lt; <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_exit_information.html">PodExitInformation</a> &gt; &amp;exits)</td></tr>
<tr class="separator:a8f8edc78a507cfcb9a7eabfe771fc36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64791dfd77dd88ae7ec74a06c29bb48f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a64791dfd77dd88ae7ec74a06c29bb48f">addPodRecord</a> (const ::ForkInput *request)</td></tr>
<tr class="separator:a64791dfd77dd88ae7ec74a06c29bb48f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b42f2e0325bc6066f8a85904f0bc72"><td class="memItemLeft" align="right" valign="top"><a id="af4b42f2e0325bc6066f8a85904f0bc72" name="af4b42f2e0325bc6066f8a85904f0bc72"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>updateStatus</b> ()</td></tr>
<tr class="separator:af4b42f2e0325bc6066f8a85904f0bc72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad385c5aa6f2fb4c9307eba07e82dccc"><td class="memItemLeft" align="right" valign="top"><a id="aad385c5aa6f2fb4c9307eba07e82dccc" name="aad385c5aa6f2fb4c9307eba07e82dccc"></a>
auto&#160;</td><td class="memItemRight" valign="bottom"><b>getStatus</b> (const std::string &amp;key)</td></tr>
<tr class="separator:aad385c5aa6f2fb4c9307eba07e82dccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52352c86c826b6e9731afb26b3cd4203"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a52352c86c826b6e9731afb26b3cd4203">isServiceExist</a> (const std::string &amp;service) const</td></tr>
<tr class="separator:a52352c86c826b6e9731afb26b3cd4203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c80689bc3138051f9a5150d98d390e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a94c80689bc3138051f9a5150d98d390e">isManagerDown</a> (const std::string &amp;manager)</td></tr>
<tr class="separator:a94c80689bc3138051f9a5150d98d390e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7033321cd272584ab601aab39f119f88"><td class="memItemLeft" align="right" valign="top"><a id="a7033321cd272584ab601aab39f119f88" name="a7033321cd272584ab601aab39f119f88"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>updateManagerTimestamp</b> (const std::string &amp;manager)</td></tr>
<tr class="separator:a7033321cd272584ab601aab39f119f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3362dc1bb886d5dd14a1b483ab06995e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a3362dc1bb886d5dd14a1b483ab06995e">getOrAddManager</a> (const std::string &amp;manager)</td></tr>
<tr class="separator:a3362dc1bb886d5dd14a1b483ab06995e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d194bb6bedfb9b4a7c967ae2fa4248"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html#a57d194bb6bedfb9b4a7c967ae2fa4248">removeManagerNotUsed</a> (int time_s)</td></tr>
<tr class="separator:a57d194bb6bedfb9b4a7c967ae2fa4248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabe683c2167449c7f4c2cceaf13d8df3"><td class="memItemLeft" align="right" valign="top"><a id="aabe683c2167449c7f4c2cceaf13d8df3" name="aabe683c2167449c7f4c2cceaf13d8df3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>start</b> ()</td></tr>
<tr class="separator:aabe683c2167449c7f4c2cceaf13d8df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a2b59e6c7acf20c62f04e75a38fba0e64"><td class="memItemLeft" align="right" valign="top"><a id="a2b59e6c7acf20c62f04e75a38fba0e64" name="a2b59e6c7acf20c62f04e75a38fba0e64"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>deletePodInManagerDescriptor</b> (<a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> *md, pid_t pid)</td></tr>
<tr class="separator:a2b59e6c7acf20c62f04e75a38fba0e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Class <a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html">WorkerNode</a> manages all process started. This class will accpect manager's request to start new process and monitor their status using signal. Once a process exits with an exit code &gt; 0, it's exit information(include exit
code, signal), stdout will be collected and send to mongodb and it's manager. Every process is also called Pod. And Every pod is bind to it's manager. If it's manager is down, the pod will be shutdown by worker. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2ddcd16a9f64fd1541514f8f7a65dbbb" name="a2ddcd16a9f64fd1541514f8f7a65dbbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ddcd16a9f64fd1541514f8f7a65dbbb">&#9670;&nbsp;</a></span>WorkerNode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tiny_swarm::worker::WorkerNode::WorkerNode </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>work_dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Constructor will do following things. 1.Check assigned directory to find available binary file. 2.Construct <a class="el" href="classtiny__swarm_1_1worker_1_1_worker_node.html">WorkerNode</a>'s bridged class. 3.Registry signal handler 4.Start inner rpc server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">work_dir</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a64791dfd77dd88ae7ec74a06c29bb48f" name="a64791dfd77dd88ae7ec74a06c29bb48f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64791dfd77dd88ae7ec74a06c29bb48f">&#9670;&nbsp;</a></span>addPodRecord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tiny_swarm::worker::WorkerNode::addPodRecord </td>
          <td>(</td>
          <td class="paramtype">const ::ForkInput *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Record service startup information. Used By Rpc Handler Class. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>The request of rpc. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a765418b0c3055848eb6ac961f23c3878" name="a765418b0c3055848eb6ac961f23c3878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a765418b0c3055848eb6ac961f23c3878">&#9670;&nbsp;</a></span>checkIfPodsRunning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiny_swarm::worker::WorkerNode::checkIfPodsRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Check services. If service is down, collect the reason and put it in down_services. If the service is marked restart, try to restart it. Only the Process that exits exceptionally will be collect reason. </p>

</div>
</div>
<a id="a8f8edc78a507cfcb9a7eabfe771fc36e" name="a8f8edc78a507cfcb9a7eabfe771fc36e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f8edc78a507cfcb9a7eabfe771fc36e">&#9670;&nbsp;</a></span>cleanDumpFiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiny_swarm::worker::WorkerNode::cleanDumpFiles </td>
          <td>(</td>
          <td class="paramtype">const std::list&lt; <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_exit_information.html">PodExitInformation</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Clean DumpFiles and Start Information of Checked Process </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exits</td><td>The ServiceExitInformation of Processes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab35e1de5d9134fcb16567ecf5ee1e747" name="ab35e1de5d9134fcb16567ecf5ee1e747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab35e1de5d9134fcb16567ecf5ee1e747">&#9670;&nbsp;</a></span>collectExitInformation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiny_swarm::worker::WorkerNode::collectExitInformation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_exit_information.html">PodExitInformation</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>exits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Worker RPC Interface. Collect The Exit Information and Try to restart Process that exits because of worker down. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The manager of services. </td></tr>
    <tr><td class="paramname">exits</td><td>The Exit Information. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5dc45b31d721f36afb4a08bcfb56315d" name="a5dc45b31d721f36afb4a08bcfb56315d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dc45b31d721f36afb4a08bcfb56315d">&#9670;&nbsp;</a></span>createProcess() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pid_t tiny_swarm::worker::WorkerNode::createProcess </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_descriptor.html">PodDescriptor</a> &amp;&#160;</td>
          <td class="paramname"><em>pd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>error_text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Inner function. Only used to restart process that requires start. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pd</td><td></td></tr>
    <tr><td class="paramname">error_text</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a id="a154586afdfdc8eb9317a4e3030d0e908" name="a154586afdfdc8eb9317a4e3030d0e908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a154586afdfdc8eb9317a4e3030d0e908">&#9670;&nbsp;</a></span>createProcess() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pid_t tiny_swarm::worker::WorkerNode::createProcess </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>service</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; char * &gt;&#160;</td>
          <td class="paramname"><em>exe_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; char * &gt;&#160;</td>
          <td class="paramname"><em>docker_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>error_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>restart</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Worker RPC Interface. Create a service using fork, and manage it. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">service</td><td>the name of service </td></tr>
    <tr><td class="paramname">alias</td><td>the id of service </td></tr>
    <tr><td class="paramname">manager</td><td>usr that create the service </td></tr>
    <tr><td class="paramname">type</td><td>0 host service, 1 docker service </td></tr>
    <tr><td class="paramname">exe_params</td><td>the params of service </td></tr>
    <tr><td class="paramname">docker_params</td><td>the params of docker container </td></tr>
    <tr><td class="paramname">error_text</td><td>error while creating service </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pid of the service </dd></dl>

</div>
</div>
<a id="a3362dc1bb886d5dd14a1b483ab06995e" name="a3362dc1bb886d5dd14a1b483ab06995e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3362dc1bb886d5dd14a1b483ab06995e">&#9670;&nbsp;</a></span>getOrAddManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> * tiny_swarm::worker::WorkerNode::getOrAddManager </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>manager</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Get a ptr of <a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> and update its timestamp.If not exist, such <a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> will be added to manages. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The name of manager. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Ptr of <a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> of manager. </dd></dl>

</div>
</div>
<a id="a94c80689bc3138051f9a5150d98d390e" name="a94c80689bc3138051f9a5150d98d390e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c80689bc3138051f9a5150d98d390e">&#9670;&nbsp;</a></span>isManagerDown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiny_swarm::worker::WorkerNode::isManagerDown </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>manager</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Worker RPC Interface. Check whether a manager is down. If manager is connected or not connected, it is described NOT DOWN. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The name of manager </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True, if manager is down. False, else </dd></dl>

</div>
</div>
<a id="a52352c86c826b6e9731afb26b3cd4203" name="a52352c86c826b6e9731afb26b3cd4203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52352c86c826b6e9731afb26b3cd4203">&#9670;&nbsp;</a></span>isServiceExist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool tiny_swarm::worker::WorkerNode::isServiceExist </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>service</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Check if service is available in this worker node. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">service</td><td>The service type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True, if available. False, else </dd></dl>

</div>
</div>
<a id="a57d194bb6bedfb9b4a7c967ae2fa4248" name="a57d194bb6bedfb9b4a7c967ae2fa4248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d194bb6bedfb9b4a7c967ae2fa4248">&#9670;&nbsp;</a></span>removeManagerNotUsed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tiny_swarm::worker::WorkerNode::removeManagerNotUsed </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time_s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Delete Only One <a class="el" href="structtiny__swarm_1_1worker_1_1_manager_descriptor.html">ManagerDescriptor</a> That Long Not Used. If expire time &lt; 0, the function never runs. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time_s</td><td>Expire Time.Second. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab1e7dcb61565460b2f6220dc600441e1" name="ab1e7dcb61565460b2f6220dc600441e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1e7dcb61565460b2f6220dc600441e1">&#9670;&nbsp;</a></span>stopDockerPod() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiny_swarm::worker::WorkerNode::stopDockerPod </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>manager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Worker RPC Interface.To Force Stop a Docker Service By Alias and Manager </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alias</td><td>The alias of Service to be stopped. </td></tr>
    <tr><td class="paramname">manager</td><td>The manger of Service to be stopped. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 success, 1 manger error, -1 kill error, -2 alias not found. </dd></dl>

</div>
</div>
<a id="a225d8b3337f181db41a4f101c5b6c99e" name="a225d8b3337f181db41a4f101c5b6c99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a225d8b3337f181db41a4f101c5b6c99e">&#9670;&nbsp;</a></span>stopDockerPod() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiny_swarm::worker::WorkerNode::stopDockerPod </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >To Force Stop a Docker Service By Pid_t </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>The ServiceDescriptor of Service to be stopped. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Is Service Stopped </dd></dl>

</div>
</div>
<a id="a1ba730850f84b99e8a6600cebfc83722" name="a1ba730850f84b99e8a6600cebfc83722"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ba730850f84b99e8a6600cebfc83722">&#9670;&nbsp;</a></span>stopHostPod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiny_swarm::worker::WorkerNode::stopHostPod </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >To Force Stop a Service By Pid_t </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sd</td><td>The Pid_t of Service to be stopped. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Is Service Stopped </dd></dl>

</div>
</div>
<a id="ad66c07d8395e4c39c13791ea4c1e3693" name="ad66c07d8395e4c39c13791ea4c1e3693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad66c07d8395e4c39c13791ea4c1e3693">&#9670;&nbsp;</a></span>stopPod() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tiny_swarm::worker::WorkerNode::stopPod </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>manager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Worker RPC Interface. To Force Stop a Service By Alias and Manager. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alias</td><td>The alias of Service to be stopped. </td></tr>
    <tr><td class="paramname">manager</td><td>The manger of Service to be stopped. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 success, 1 manger error, -1 kill error, -2 alias not found. </dd></dl>

</div>
</div>
<a id="ae429841d6f8d4a57291110eefed7ba5f" name="ae429841d6f8d4a57291110eefed7ba5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae429841d6f8d4a57291110eefed7ba5f">&#9670;&nbsp;</a></span>stopPod() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tiny_swarm::worker::WorkerNode::stopPod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtiny__swarm_1_1worker_1_1_pod_descriptor.html">PodDescriptor</a> *&#160;</td>
          <td class="paramname"><em>pd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Inner function. To Force Stop a Host Service Or Docker Service By <a class="el" href="structtiny__swarm_1_1worker_1_1_pod_descriptor.html">PodDescriptor</a>. Only used to stop manager's pods. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pd</td><td>The ServiceDescriptor of Service to be stopped. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Is Service Stopped </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>worker/<a class="el" href="_worker_node_8h_source.html">WorkerNode.h</a></li>
<li>worker/WorkerNode.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
